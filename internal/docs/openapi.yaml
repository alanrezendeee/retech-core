openapi: 3.0.3
info:
  title: Retech Core API
  version: 1.0.0
  description: |
    # ðŸš€ Retech Core API
    
    A API definitiva de dados brasileiros para desenvolvedores.
    
    ## ðŸŽ¯ CaracterÃ­sticas
    
    - âš¡ **Performance**: Respostas em <100ms
    - ðŸ”’ **SeguranÃ§a**: API Key + Rate Limiting
    - ðŸ“Š **Dados**: Geografia, CEP, CNPJ, CPF e mais
    - ðŸŽ **Gratuito**: 1.000 requests/dia no plano Free
    
    ## ðŸ” AutenticaÃ§Ã£o
    
    Use o header `X-API-Key` com sua chave de API:
    
    ```bash
    curl __API_BASE_URL__/geo/ufs \
      -H "X-API-Key: sua_api_key_aqui"
    ```
    
    ## ðŸ“ˆ Rate Limiting
    
    - **Plano Free**: 1.000 requests/dia, 60/min
    - **Plano Pro**: 10.000 requests/dia, 200/min
    - **Plano Business**: Custom
    
    ## ðŸ“š Mais InformaÃ§Ãµes
    
    - **Portal do Desenvolvedor**: https://core.theretech.com.br
    - **DocumentaÃ§Ã£o Completa**: https://core.theretech.com.br/painel/docs
    - **Status**: https://status.theretech.com.br
    
  contact:
    name: Retech Support
    email: suporte@theretech.com.br
    url: https://core.theretech.com.br
  license:
    name: Proprietary
    url: https://core.theretech.com.br/termos

servers:
  - url: __API_BASE_URL__

tags:
  - name: Infraestrutura
    description: Health checks e informaÃ§Ãµes do sistema
  - name: Geografia
    description: Estados, municÃ­pios e dados geogrÃ¡ficos do Brasil

paths:
  # ==========================================
  # INFRAESTRUTURA
  # ==========================================
  /health:
    get:
      tags: [Infraestrutura]
      summary: Health Check
      description: Verifica se a API estÃ¡ funcionando
      responses:
        '200':
          description: API funcionando normalmente
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "healthy"

  /version:
    get:
      tags: [Infraestrutura]
      summary: VersÃ£o da API
      description: Retorna informaÃ§Ãµes sobre a versÃ£o atual
      responses:
        '200':
          description: InformaÃ§Ãµes da versÃ£o
          content:
            application/json:
              schema:
                type: object
                properties:
                  version:
                    type: string
                    example: "1.0.0"
                  environment:
                    type: string
                    example: "production"

  # ==========================================
  # GEOGRAFIA
  # ==========================================
  /geo/ufs:
    get:
      tags: [Geografia]
      summary: Listar Estados
      description: |
        Retorna todos os 27 estados brasileiros com informaÃ§Ãµes completas.
        
        **Exemplo de uso:**
        ```bash
        curl __API_BASE_URL__/geo/ufs \
          -H "X-API-Key: sua_api_key_aqui"
        ```
      security:
        - ApiKeyAuth: []
      responses:
        '200':
          description: Lista de estados
          content:
            application/json:
              schema:
                type: object
                properties:
                  estados:
                    type: array
                    items:
                      $ref: '#/components/schemas/Estado'
              example:
                estados:
                  - id: 26
                    sigla: "PE"
                    nome: "Pernambuco"
                    regiao:
                      id: 2
                      sigla: "NE"
                      nome: "Nordeste"
        '401':
          $ref: '#/components/responses/Unauthorized'
        '429':
          $ref: '#/components/responses/TooManyRequests'
        '503':
          $ref: '#/components/responses/Maintenance'

  /geo/ufs/{sigla}:
    get:
      tags: [Geografia]
      summary: Buscar Estado por Sigla
      description: |
        Retorna detalhes de um estado especÃ­fico pela sigla.
        
        **Exemplo de uso:**
        ```bash
        curl __API_BASE_URL__/geo/ufs/PE \
          -H "X-API-Key: sua_api_key_aqui"
        ```
      security:
        - ApiKeyAuth: []
      parameters:
        - name: sigla
          in: path
          required: true
          description: "Sigla do estado (ex: SP, RJ, PE)"
          schema:
            type: string
            example: "PE"
      responses:
        '200':
          description: Detalhes do estado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Estado'
              example:
                id: 26
                sigla: "PE"
                nome: "Pernambuco"
                regiao:
                  id: 2
                  sigla: "NE"
                  nome: "Nordeste"
        '404':
          $ref: '#/components/responses/NotFound'
        '401':
          $ref: '#/components/responses/Unauthorized'

  /geo/municipios:
    get:
      tags: [Geografia]
      summary: Listar MunicÃ­pios
      description: |
        Retorna todos os municÃ­pios ou filtra por UF/nome.
        
        **Exemplo de uso:**
        ```bash
        # Todos os municÃ­pios
        curl __API_BASE_URL__/geo/municipios \
          -H "X-API-Key: sua_api_key_aqui"
        
        # Filtrar por UF
        curl "__API_BASE_URL__/geo/municipios?uf=PE" \
          -H "X-API-Key: sua_api_key_aqui"
        
        # Buscar por nome
        curl "__API_BASE_URL__/geo/municipios?q=Recife" \
          -H "X-API-Key: sua_api_key_aqui"
        ```
      security:
        - ApiKeyAuth: []
      parameters:
        - name: uf
          in: query
          description: "Filtrar por UF (ex: PE, SP)"
          schema:
            type: string
            example: "PE"
        - name: q
          in: query
          description: Buscar por nome
          schema:
            type: string
            example: "Recife"
      responses:
        '200':
          description: Lista de municÃ­pios
          content:
            application/json:
              schema:
                type: object
                properties:
                  municipios:
                    type: array
                    items:
                      $ref: '#/components/schemas/Municipio'

  /geo/municipios/{uf}:
    get:
      tags: [Geografia]
      summary: MunicÃ­pios de um Estado
      description: |
        Retorna todos os municÃ­pios de um estado especÃ­fico.
        
        **Exemplo de uso:**
        ```bash
        curl __API_BASE_URL__/geo/municipios/PE \
          -H "X-API-Key: sua_api_key_aqui"
        ```
      security:
        - ApiKeyAuth: []
      parameters:
        - name: uf
          in: path
          required: true
          description: Sigla do estado
          schema:
            type: string
            example: "PE"
      responses:
        '200':
          description: Lista de municÃ­pios do estado
          content:
            application/json:
              schema:
                type: object
                properties:
                  municipios:
                    type: array
                    items:
                      $ref: '#/components/schemas/Municipio'

components:
  schemas:
    Estado:
      type: object
      description: Representa um estado brasileiro
      properties:
        id:
          type: integer
          description: CÃ³digo IBGE do estado
          example: 26
        sigla:
          type: string
          description: Sigla UF (2 caracteres)
          example: "PE"
        nome:
          type: string
          description: Nome do estado
          example: "Pernambuco"
        regiao:
          $ref: '#/components/schemas/Regiao'

    Regiao:
      type: object
      description: RegiÃ£o geogrÃ¡fica brasileira
      properties:
        id:
          type: integer
          description: CÃ³digo IBGE da regiÃ£o
          example: 2
        sigla:
          type: string
          description: Sigla da regiÃ£o
          example: "NE"
        nome:
          type: string
          description: Nome da regiÃ£o
          example: "Nordeste"

    Municipio:
      type: object
      description: Representa um municÃ­pio brasileiro
      properties:
        id:
          type: integer
          description: CÃ³digo IBGE do municÃ­pio
          example: 2611606
        nome:
          type: string
          description: Nome do municÃ­pio
          example: "Recife"
        microrregiao:
          type: object
          description: MicrorregiÃ£o do IBGE
        regiao-imediata:
          type: object
          description: RegiÃ£o imediata (nova divisÃ£o IBGE)

    Error:
      type: object
      description: Resposta de erro padronizada (RFC 7807)
      properties:
        type:
          type: string
          description: URI que identifica o tipo de erro
          example: "https://retech-core/errors/not-found"
        title:
          type: string
          description: Resumo do erro
          example: "Not Found"
        status:
          type: integer
          description: CÃ³digo HTTP
          example: 404
        detail:
          type: string
          description: ExplicaÃ§Ã£o detalhada do erro
          example: "Recurso nÃ£o encontrado"

  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: header
      name: X-API-Key
      description: |
        ## Como usar sua API Key
        
        Todas as requisiÃ§Ãµes para endpoints `/geo/*` requerem autenticaÃ§Ã£o via API Key.
        
        **Passo 1: Obter sua API Key**
        
        Acesse o [Portal do Desenvolvedor](https://core.theretech.com.br/painel/apikeys) e gere uma nova chave.
        
        **Passo 2: Usar no header**
        
        ```bash
        curl __API_BASE_URL__/geo/ufs \
          -H "X-API-Key: sua_api_key_aqui"
        ```
        
        **Rate Limits:**
        - Plano Free: 1.000 requests/dia, 60/min
        - Plano Pro: 10.000 requests/dia, 200/min

  responses:
    Unauthorized:
      description: NÃ£o autorizado - API Key invÃ¡lida ou ausente
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            type: "https://retech-core/errors/unauthorized"
            title: "Unauthorized"
            status: 401
            detail: "API Key invÃ¡lida ou ausente. Use o header X-API-Key com uma chave vÃ¡lida."

    NotFound:
      description: Recurso nÃ£o encontrado
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            type: "https://retech-core/errors/not-found"
            title: "Not Found"
            status: 404
            detail: "O recurso solicitado nÃ£o foi encontrado."

    TooManyRequests:
      description: Rate limit excedido
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            type: "https://retech-core/errors/rate-limit"
            title: "Too Many Requests"
            status: 429
            detail: "VocÃª excedeu o limite de requisiÃ§Ãµes. Tente novamente mais tarde."

    Maintenance:
      description: API em manutenÃ§Ã£o
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            type: "https://retech-core/errors/maintenance"
            title: "API em ManutenÃ§Ã£o"
            status: 503
            detail: "A API estÃ¡ temporariamente indisponÃ­vel para manutenÃ§Ã£o. Por favor, tente novamente mais tarde."
